<div class="venue-section">
  <!-- Header -->
  <div class="venue-header">
    <div class="venue-title">
      <div class="venue-icon">{{ venueName.includes('Arena') ? 'üèüÔ∏è' : 'üé≠' }}</div>
      <div>
        <h1>{{ venueName }}</h1>
        <p>Select a section to view details and book tickets</p>
        <div class="grid-info">
          <span class="grid-badge">12-Column Grid System</span>
          <span class="grid-badge">{{ getVisibleSections().length }} Sections</span>
        </div>
      </div>
    </div>
  </div>

  <!-- SVG Container -->
  <div class="svg-container">
    <svg [attr.viewBox]="'0 0 ' + layout.width + ' ' + layout.height" 
         preserveAspectRatio="xMidYMid meet"
         class="venue-svg">
      
      <!-- Gradient Definitions -->
      <defs>
        <!-- Predefined Gradients -->
        <linearGradient id="stage-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#1e293b" />
          <stop offset="50%" stop-color="#0f172a" />
          <stop offset="100%" stop-color="#020617" />
        </linearGradient>
        
        <linearGradient id="vip-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#A855F7" />
          <stop offset="50%" stop-color="#7C3AED" />
          <stop offset="100%" stop-color="#6B21A8" />
        </linearGradient>
        
        <linearGradient id="diamond-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#38BDF8" />
          <stop offset="50%" stop-color="#0EA5E9" />
          <stop offset="100%" stop-color="#0284C7" />
        </linearGradient>
        
        <linearGradient id="gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#FBBF24" />
          <stop offset="50%" stop-color="#F59E0B" />
          <stop offset="100%" stop-color="#D97706" />
        </linearGradient>
        
        <linearGradient id="silver-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#94A3B8" />
          <stop offset="50%" stop-color="#64748b" />
          <stop offset="100%" stop-color="#475569" />
        </linearGradient>
        
        <linearGradient id="standing-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#34D399" />
          <stop offset="50%" stop-color="#10B981" />
          <stop offset="100%" stop-color="#059669" />
        </linearGradient>
        
        <linearGradient id="foh-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#475569" />
          <stop offset="50%" stop-color="#334155" />
          <stop offset="100%" stop-color="#1e293b" />
        </linearGradient>
        
        <!-- Shadow Filter -->
        <filter id="section-shadow" x="-20%" y="-20%" width="140%" height="140%">
          <feGaussianBlur in="SourceAlpha" stdDeviation="4"/>
          <feOffset dx="0" dy="3" result="offsetblur"/>
          <feComponentTransfer>
            <feFuncA type="linear" slope="0.25"/>
          </feComponentTransfer>
          <feMerge>
            <feMergeNode/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
        
        <!-- Hover Filter -->
        <filter id="section-hover" x="-20%" y="-20%" width="140%" height="140%">
          <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
          <feOffset dx="0" dy="4" result="offsetblur"/>
          <feComponentTransfer>
            <feFuncA type="linear" slope="0.3"/>
          </feComponentTransfer>
          <feMerge>
            <feMergeNode/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      
      <!-- Optional Grid Background (toggle with *ngIf) -->
      <g class="grid-background" *ngIf="false">
        <rect x="0" y="0" [attr.width]="layout.width" [attr.height]="layout.height" 
              fill="#f8fafc" opacity="0.2"/>
        
        <!-- Horizontal Grid Lines -->
        <g *ngFor="let i of [0,1,2,3,4,5,6]">
          <line x1="0" 
                [attr.y1]="layout.containerPadding + (i * (layout.rowHeight + layout.rowGap))"
                [attr.x2]="layout.width"
                [attr.y2]="layout.containerPadding + (i * (layout.rowHeight + layout.rowGap))"
                stroke="#cbd5e1" stroke-width="1" stroke-dasharray="3,3"/>
        </g>
        
        <!-- Vertical Grid Lines -->
        <g *ngFor="let i of [0,1,2,3,4,5,6,7,8,9,10,11,12]">
          <line [attr.x1]="layout.containerPadding + (i * layout.columnWidth)" 
                y1="0"
                [attr.x2]="layout.containerPadding + (i * layout.columnWidth)" 
                [attr.y2]="layout.height"
                stroke="#cbd5e1" stroke-width="1" stroke-dasharray="3,3"/>
        </g>
      </g>
      
      <!-- Render All Positioned Sections -->
      <g *ngFor="let section of positionedSections" 
         [class]="'venue-section-item ' + section.type"
         (click)="onSectionClick(section)"
         (mouseenter)="showTooltip(section)"
         (mouseleave)="hideTooltip()"
         [class.clickable]="section.type !== 'stage' && section.type !== 'container'"
         [class.disabled]="isSoldOut(section) && section.type !== 'stage' && section.type !== 'foh' && section.type !== 'container'"
         [class.hovered]="hoveredSection === section">
        
        <!-- Section Rectangle -->
        <rect [attr.x]="section.x" 
              [attr.y]="section.y"
              [attr.width]="section.calculatedWidth" 
              [attr.height]="section.calculatedHeight" 
              [attr.rx]="section.type === 'standing' ? '12' : section.type === 'stage' ? '8' : '10'"
              [attr.fill]="'url(#' + getGradientId(section) + ')'"
              [attr.stroke]="section.type === 'stage' ? '#fbbf24' : '#ffffff'"
              [attr.stroke-width]="section.type === 'stage' ? '3' : '2'"
              class="section-rect"
              [attr.filter]="hoveredSection === section ? 'url(#section-hover)' : 'url(#section-shadow)'"
              style="transition: all 0.3s ease;"/>
        
        <!-- Section Icon -->
        <text *ngIf="section.icon && section.type !== 'container'"
              [attr.x]="section.x! + (section.type === 'standing' ? 20 : 40)"
              [attr.y]="section.y! + (section.type === 'stage' ? 60 : 40)"
              text-anchor="start"
              fill="#ffffff"
              font-size="24"
              font-family="Arial, sans-serif"
              style="pointer-events: none;">
          {{ section.icon }}
        </text>
        
        <!-- Section Name -->
        <text [attr.x]="section.x! + (section.type === 'standing' ? section.calculatedWidth! / 2 : section.calculatedWidth! / 2)" 
              [attr.y]="section.y! + (section.type === 'stage' ? 
                        section.calculatedHeight! / 2 + 10 : 
                        section.type === 'standing' ? section.calculatedHeight! / 2 + 8 : section.calculatedHeight! / 2 - 10)"
              text-anchor="middle" 
              fill="#ffffff" 
              [attr.font-size]="section.type === 'stage' ? '28' : section.type === 'standing' ? '14' : '16'" 
              font-weight="700"
              [attr.letter-spacing]="section.type === 'stage' ? '4' : '1'"
              font-family="Arial, sans-serif"
              style="pointer-events: none;">
          {{ section.name }}
        </text>
        
        <!-- Price -->
        <text *ngIf="(section.type === 'seated' || section.type === 'standing') && section.price"
              [attr.x]="section.x! + section.calculatedWidth! / 2" 
              [attr.y]="section.y! + (section.type === 'standing' ? section.calculatedHeight! / 2 + 30 : section.calculatedHeight! / 2 + 14)"
              text-anchor="middle" 
              fill="#ffffff" 
              font-size="14" 
              font-weight="600"
              opacity="0.95"
              font-family="Arial, sans-serif"
              style="pointer-events: none;">
          {{ formatPrice(section.price) }}
        </text>
        
        <!-- Available Seats Badge -->
        <g *ngIf="section.availableSeats && section.availableSeats > 0 && (section.type === 'seated' || section.type === 'standing')">
          <rect [attr.x]="section.x! + section.calculatedWidth! - 60" 
                [attr.y]="section.y! + 10"
                width="50"
                height="24"
                fill="rgba(255, 255, 255, 0.9)"
                rx="12"
                stroke="#f3f4f6"
                stroke-width="1.5"/>
          
          <text [attr.x]="section.x! + section.calculatedWidth! - 35" 
                [attr.y]="section.y! + 25"
                text-anchor="middle" 
                fill="#111827" 
                font-size="12" 
                font-weight="700"
                font-family="Arial, sans-serif">
            {{ section.availableSeats }}
          </text>
        </g>
        
        <!-- Sold Out Badge -->
        <g *ngIf="isSoldOut(section) && section.type !== 'stage' && section.type !== 'foh' && section.type !== 'container'">
          <rect [attr.x]="section.x! + section.calculatedWidth! / 2 - 40" 
                [attr.y]="section.y! + 10"
                width="80"
                height="24"
                fill="#ef4444"
                rx="12"/>
          
          <text [attr.x]="section.x! + section.calculatedWidth! / 2" 
                [attr.y]="section.y! + 26"
                text-anchor="middle" 
                fill="#ffffff" 
                font-size="11" 
                font-weight="700"
                font-family="Arial, sans-serif">
            SOLD OUT
          </text>
        </g>
        
        <!-- View Seats Button -->
        <g *ngIf="section.type === 'seated' && section.availableSeats && section.availableSeats > 0"
           class="view-seats-btn"
           (click)="openSeatPreview(section); $event.stopPropagation()"
           style="cursor: pointer;">
          <rect [attr.x]="section.x! + section.calculatedWidth! - 52"
                [attr.y]="section.y! + section.calculatedHeight! - 52"
                width="40"
                height="40"
                rx="8"
                fill="rgba(255,255,255,0.95)"
                stroke="#3b82f6"
                stroke-width="2"
                style="transition: all 0.2s ease;"/>
          
          <text [attr.x]="section.x! + section.calculatedWidth! - 32"
                [attr.y]="section.y! + section.calculatedHeight! - 25"
                text-anchor="middle"
                fill="#3b82f6"
                font-size="16"
                font-weight="700"
                font-family="Arial, sans-serif">
            üëÅÔ∏è
          </text>
        </g>
        
        <!-- Seating Info -->
        <text *ngIf="section.type === 'seated' && section.rows && section.columns"
              [attr.x]="section.x! + section.calculatedWidth! / 2" 
              [attr.y]="section.y! + section.calculatedHeight! - 15"
              text-anchor="middle" 
              fill="rgba(255,255,255,0.8)" 
              font-size="11" 
              font-weight="500"
              font-family="Arial, sans-serif"
              style="pointer-events: none;">
          {{ section.rows }} √ó {{ section.columns }} seats
        </text>
      </g>
      
      <!-- Hover Tooltip -->
      <g *ngIf="hoveredSection && hoveredSection.type !== 'stage' && hoveredSection.type !== 'container'"
         class="hover-tooltip"
         style="pointer-events: none;">
        <rect [attr.x]="getTooltipX(hoveredSection)"
              [attr.y]="getTooltipY(hoveredSection)"
              width="160"
              height="80"
              rx="8"
              fill="#1f2937"
              opacity="0.98"
              stroke="#374151"
              stroke-width="1"
              style="filter: drop-shadow(0 4px 12px rgba(0,0,0,0.3));"/>
        
        <polygon [attr.points]="getTooltipX(hoveredSection) + 80 - 8 + ',' + (getTooltipY(hoveredSection) + 80) + ' ' + 
                               (getTooltipX(hoveredSection) + 80) + ',' + (getTooltipY(hoveredSection) + 72) + ' ' + 
                               (getTooltipX(hoveredSection) + 80 + 8) + ',' + (getTooltipY(hoveredSection) + 80)"
                 fill="#1f2937"
                 stroke="#374151"
                 stroke-width="1"/>
        
        <text [attr.x]="getTooltipX(hoveredSection) + 80"
              [attr.y]="getTooltipY(hoveredSection) + 25"
              text-anchor="middle"
              fill="#ffffff"
              font-size="13"
              font-weight="600"
              font-family="Arial, sans-serif">
          {{ hoveredSection.name }}
        </text>
        
        <text [attr.x]="getTooltipX(hoveredSection) + 80"
              [attr.y]="getTooltipY(hoveredSection) + 45"
              text-anchor="middle"
              fill="#d1d5db"
              font-size="11"
              font-weight="500"
              font-family="Arial, sans-serif">
          {{ hoveredSection.type !== 'foh' ? (formatPrice(hoveredSection.price) + ' per ' + (hoveredSection.type === 'standing' ? 'person' : 'seat')) : 'Free Access' }}
        </text>
        
        <text [attr.x]="getTooltipX(hoveredSection) + 80"
              [attr.y]="getTooltipY(hoveredSection) + 65"
              text-anchor="middle"
              [attr.fill]="isSoldOut(hoveredSection) ? '#ef4444' : '#10b981'"
              font-size="11"
              font-weight="600"
              font-family="Arial, sans-serif">
          {{ isSoldOut(hoveredSection) ? 'SOLD OUT' : 
             hoveredSection.availableSeats + (hoveredSection.type === 'standing' ? ' capacity' : ' seats available') }}
        </text>
      </g>
    </svg>
  </div>

  <!-- Selected Section Details -->
  <div class="selected-section-details" *ngIf="selectedSection">
    <div class="details-header">
      <div class="details-icon-wrapper">
        <div class="details-icon" [style.background]="getSectionGradient(selectedSection)">
          {{ getSectionIcon(selectedSection) }}
        </div>
      </div>
      <div class="details-title">
        <h3>{{ selectedSection.name }}</h3>
        <p class="details-type">{{ selectedSection.type | uppercase }} SECTION</p>
      </div>
      <button class="close-details" (click)="selectedSection = null">√ó</button>
    </div>
    
    <div class="details-content">
      <div class="details-price">
        <span class="price-label">Price per {{ selectedSection.type === 'standing' ? 'person' : 'seat' }}</span>
        <span class="price-value">{{ formatPrice(selectedSection.price) }}</span>
      </div>
      
      <div class="details-description">
        <p>{{ getSectionDescription(selectedSection.id) }}</p>
        
        <div class="benefits-list" *ngIf="getSectionBenefits(selectedSection.id).length > 0">
          <h4>Benefits:</h4>
          <ul>
            <li *ngFor="let benefit of getSectionBenefits(selectedSection.id)">‚úì {{ benefit }}</li>
          </ul>
        </div>
      </div>
      
      <div class="details-availability" *ngIf="selectedSection.availableSeats !== undefined && selectedSection.totalSeats !== undefined">
        <div class="availability-header">
          <span>Availability</span>
          <span class="availability-count">{{ selectedSection.availableSeats }} / {{ selectedSection.totalSeats }} available</span>
        </div>
        <div class="availability-bar">
          <div class="availability-fill" 
               [style.width.%]="getAvailabilityPercentage(selectedSection)">
          </div>
        </div>
        <div class="availability-percentage">
          {{ getAvailabilityPercentage(selectedSection) | number:'1.0-0' }}% available
        </div>
      </div>
      
      <div class="details-actions">
        <button class="btn-view-seats" 
                *ngIf="selectedSection.type === 'seated' && selectedSection.availableSeats && selectedSection.availableSeats > 0"
                (click)="openSeatPreview(selectedSection)">
          View & Select Seats
        </button>
        <button class="btn-book" 
                *ngIf="selectedSection.type === 'standing' && selectedSection.availableSeats && selectedSection.availableSeats > 0">
          Book Standing Tickets
        </button>
        <div class="sold-out-message" *ngIf="isSoldOut(selectedSection)">
          ‚ùå This section is currently sold out
        </div>
      </div>
    </div>
  </div>

  <!-- Seat Preview Modal -->
  <div class="seat-preview-modal" *ngIf="showSeatPreview && selectedSectionPreview">
    <div class="modal-overlay" (click)="closeSeatPreview()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h3>{{ selectedSectionPreview.name }} - Seat Selection</h3>
          <p class="modal-subtitle">Select up to 8 seats</p>
        </div>
        <button class="close-modal" (click)="closeSeatPreview()">√ó</button>
      </div>
      
      <div class="modal-body">
        <div class="seat-preview-container">
          <!-- Stage Indicator -->
          <div class="stage-indicator">
            <div class="stage-marker">üé≠</div>
            <span>STAGE</span>
          </div>
          
          <!-- Seat Grid -->
          <div class="seat-grid">
            <div *ngFor="let row of seatPreviewSeats; let rowIndex = index" class="seat-row">
              <div *ngFor="let seat of row; let colIndex = index" 
                   [class]="'seat ' + (seat.isAisle ? 'aisle' : '') + (seat.available ? ' available' : ' unavailable') + (isSeatSelected(seat) ? ' selected' : '')"
                   (click)="toggleSeatSelection(seat)">
                
                <div *ngIf="!seat.isAisle" class="seat-number">
                  {{ seat.number }}
                </div>
                <div *ngIf="seat.isAisle" class="aisle-label">
                  {{ seat.label }}
                </div>
              </div>
            </div>
          </div>
          
          <!-- Seat Legend -->
          <div class="seat-legend">
            <div class="legend-item">
              <div class="legend-color available"></div>
              <span>Available</span>
            </div>
            <div class="legend-item">
              <div class="legend-color selected"></div>
              <span>Selected</span>
            </div>
            <div class="legend-item">
              <div class="legend-color unavailable"></div>
              <span>Unavailable</span>
            </div>
            <div class="legend-item">
              <div class="legend-color aisle"></div>
              <span>Aisle</span>
            </div>
          </div>
        </div>
        
        <!-- Selection Summary -->
        <div class="selection-summary" *ngIf="selectedSeats.length > 0">
          <h4>Selected Seats ({{ selectedSeats.length }}/8):</h4>
          <div class="selected-seats-list">
            <span *ngFor="let seat of selectedSeats" class="seat-badge">
              Row {{ seat.row }}, Seat {{ seat.column }}
            </span>
          </div>
          <div class="price-summary">
            <div class="price-item">
              <span>Tickets ({{ selectedSeats.length }} √ó {{ formatPrice(selectedSectionPreview.price) }})</span>
              <span>{{ formatPrice(selectedSeats.length * (selectedSectionPreview.price || 0)) }}</span>
            </div>
            <div class="price-total">
              <span>Total</span>
              <span class="total-amount">{{ formatPrice(selectedSeats.length * (selectedSectionPreview.price || 0)) }}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn-cancel" (click)="closeSeatPreview()">Cancel</button>
        <button class="btn-confirm" 
                (click)="bookSelectedSeats()"
                [disabled]="selectedSeats.length === 0">
          Confirm Booking
        </button>
      </div>
    </div>
  </div>
</div>